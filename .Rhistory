'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(Orden)
Barrios_CABA <- left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
Barrios_CABA <- left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
Barrios_CABA <- left_join(resumen_barrio, by = c("Barrio_Recod" = "BARRIO"))
Resumen_CABA <- Barrios_CABA %>% left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
View(Resumen_CABA)
Resumen_CABA <- Barrios_CABA %>%
select(-Barrios) %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
Resumen_CABA <- Barrios_CABA %>%
select(-Barrios) %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- Barrios_CABA %>% left_join(BarriosRecod, by = c("BARRIO" = "Barrio_Recod"))
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- Barrios_CABA %>% left_join(BarriosRecod, by = c("BARRIO" = "Barrio_Recod"))
View(Barrios_CABA)
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- Barrios_CABA %>%
select(-Barrios) %>%
left_join(BarriosRecod, by = c("BARRIO" = "Barrio_Recod"))
Resumen_CABA <- Barrios_CABA %>%
select(-Barrios) %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
resumen_barrio <- Zonaprop_Precio %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Precio' = sum(PrecioPesos) / n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(Orden)
resumen_barrio <- Zonaprop_Precio %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Precio' = sum(PrecioPesos) / n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
leaflet() %>%
addTiles() %>%
addPolygons(
data = Resumen_CABA,
fillColor = ~Precio,
stroke = FALSE,
fillOpacity = 1
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = Resumen_CABA,
fillColor = ~Precio,
stroke = FALSE,
fillOpacity = 0.2
)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  )
pal <- colorNumeric("viridis", NULL)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  )
pal <- colorNumeric("Blues", NULL)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  )
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(Longitud, Latitud)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(data = Zonaprop_Mapa,Longitud, Latitud)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(data = Zonaprop_Mapa, Longitud, Latitud)
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(
data = Zonaprop_Mapa, lng = Longitud, lat = Latitud))
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(
data = Zonaprop_Mapa, lng = Longitud, lat = Latitud)
leaflet() %>%
addMarkers(data = Zonaprop_Mapa, lng = Longitud, lat = Latitud)
leaflet() %>%
addMarkers(data = Zonaprop_Mapa, lng = Longitud, lat = Latitud)
leaflet() %>%
addMarkers(data = Zonaprop_Mapa, ~as.numeric(Long), ~as.numeric(Lat))
leaflet() %>%
addMarkers(data = Zonaprop_Mapa, ~as.numeric(Longitud), ~as.numeric(Latitud))
leaflet() %>%
addTiles() %>%
addPolygons(data = Resumen_CABA, stroke = FALSE, smoothFactor = 0.3, fillOpacity = 0.7,
color = ~pal(log10(Precio)),
opacity = 1,
popup = paste("<a><strong>", Resumen_CABA$BARRIO,"</strong></a><br>",
"Propiedades: ", Resumen_CABA$Total, "<br>",
"Precio promedio: ", Resumen_CABA$`Promedio precio`, "<br>",
"% Dolarizado: ", Resumen_CABA$`Porcentaje dolarizado`, "<br>")) %>%
addLegend("topright", pal = pal, values = Resumen_CABA$Precio,
title = "Precio promedio"  ) %>%
addMarkers(data = Zonaprop_Mapa, ~as.numeric(Longitud), ~as.numeric(Latitud))
puntos_sf <- st_as_sf(Zonaprop, coords = c("Longitud", "Latitud"), crs = 4326)
puntos_sf <- st_as_sf(Zonaprop_Mapa, coords = c("Longitud", "Latitud"), crs = 4326)
resultado <- st_intersection(Barrios_CABA, puntos_sf)
resultado <- st_intersection(Barrios_CABA, puntos_sf)
### CARGO PAQUETES
library(leaflet)
library(readxl)
library(maps)
library(sf)
library(geojsonio)
library(googlesheets4)
library(dplyr)
library(gt)
library(DT)
library(ggplot2)
library(readr)
library(leaflet.extras)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
## Traida de bases + armado general
setwd("C:/Users/Sebastián/Documents")
Zonaprop <- read_csv("~/Trabajos Propios/zonaprop 2024-04-24alquiler-capital-federal.csv")
## Saco duplicados
Zonaprop <- unique(Zonaprop)
BarriosRecod <- read_excel("~/Trabajos Propios/OMI/Barrios_Recodificado.xlsx")
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Zonaprop <- Zonaprop %>%
mutate(RangosPrecio = case_when(
PrecioPesos < 200000 ~ "Menor a 200",
PrecioPesos >= 200000 & PrecioPesos < 400000  ~ "200 a 400",
PrecioPesos >= 400000 & PrecioPesos < 600000  ~ "400 a 600",
PrecioPesos >= 600000 & PrecioPesos < 800000  ~ "600 a 800",
PrecioPesos >= 800000 & PrecioPesos < 1000000  ~ "800 a 1.000",
PrecioPesos >= 1000000 & PrecioPesos < 1500000  ~ "1.000 a 1.500",
PrecioPesos >= 1500000 & PrecioPesos < 2000000  ~ "1.500 a 2.000",
PrecioPesos >= 2000000 ~ "Mayor a 2.000")) %>%
mutate(RangosAmbientes = case_when(
Ambientes == 1 ~ "1 ambiente",
Ambientes == 2 ~ "2 ambientes",
Ambientes == 3 ~ "3 ambientes",
Ambientes == 4 ~ "4 ambientes",
Ambientes > 4  ~ "5 ambientes"))
ResumenBarriosCABA <- Zonaprop %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
ResumenBarriosCABA <- Zonaprop %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
ResumenBarriosCABA <- Zonaprop %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
Zonaprop <- Zonaprop %>% left_join(BarriosRecod,by = "Barrios")
Zonaprop <- read_csv("~/Trabajos Propios/zonaprop 2024-04-24alquiler-capital-federal.csv")
## Saco duplicados
Zonaprop <- unique(Zonaprop)
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
Barrios_CABA <- geojson_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
shiny::runApp('Trabajos Propios/OMI/Tablero-OMI')
runApp('Trabajos Propios/OMI/Tablero-OMI')
resumen_barrio <- Zonaprop_Precio %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Precio' = sum(PrecioPesos) / n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod"))
View(Resumen_CABA)
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(!is.na(Precio) ~ 0))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0
TRUE ~ as.numeric(Precio)))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0
TRUE ~ as.numeric(Precio)))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0,
TRUE ~ as.numeric(Precio)))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0,
TRUE ~ as.numeric(Precio)),
Total = case_when(is.na(Total) ~ 0,
TRUE ~ as.numeric(Total)))
runApp('Trabajos Propios/OMI/Tablero-OMI')
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0,
TRUE ~ as.numeric(Precio)),
Total = case_when(is.na(Total) ~ 0,
TRUE ~ as.numeric(Total)))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0,
TRUE ~ as.numeric(Precio)),
Total = case_when(is.na(Total) ~ 0,
TRUE ~ as.numeric(Total)))
runApp('Trabajos Propios/OMI/Tablero-OMI')
View(Resumen_CABA)
### CARGO PAQUETES
library(leaflet)
library(readxl)
library(maps)
library(sf)
library(geojsonio)
library(googlesheets4)
library(dplyr)
library(gt)
library(DT)
library(ggplot2)
library(readr)
library(leaflet.extras)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
library(rsconnect)
rsconnect::setAccountInfo(name='observatoriovivienda',
token='C1CB75089ECDFE54E6058028A3FA52AB',
secret='LXfPml47up9ITHdGRYAx/lkPQ9LFnMHfumBeeK0K')
Zonaprop <- read_csv("zonaprop 2024-04-24alquiler-capital-federal.csv")
setwd(setwd("C:/Users/Sebastián/Documents/Trabajos Propios/OMI/Tabler-OMI"))
setwd(setwd("C:/Users/Sebastián/Documents/Trabajos Propios/OMI/Tablero-OMI"))
setwd(setwd("C:/Users/Sebastián/Documents/Trabajos Propios/OMI/Tablero-OMI"))
CARGO PAQUETES
### CARGO PAQUETES
library(leaflet)
library(readxl)
library(maps)
library(sf)
library(geojsonio)
library(googlesheets4)
library(dplyr)
library(gt)
library(DT)
library(ggplot2)
library(readr)
library(leaflet.extras)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
library(rsconnect)
Zonaprop <- read_csv("zonaprop 2024-04-24alquiler-capital-federal.csv")
setwd("C:/Users/Sebastián/Documents/Trabajos Propios/OMI/Tablero-OMI")
### CARGO PAQUETES
library(leaflet)
library(readxl)
library(maps)
library(sf)
library(geojsonio)
library(googlesheets4)
library(dplyr)
library(gt)
library(DT)
library(ggplot2)
library(readr)
library(leaflet.extras)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
library(rsconnect)
Zonaprop <- read_csv("zonaprop 2024-04-24alquiler-capital-federal.csv")
### CARGO PAQUETES
library(leaflet)
library(readxl)
library(maps)
library(sf)
library(geojsonio)
library(googlesheets4)
library(dplyr)
library(gt)
library(DT)
library(ggplot2)
library(readr)
library(leaflet.extras)
library(RColorBrewer)
library(shiny)
library(shinydashboard)
library(rsconnect)
Zonaprop <- read_csv("zonaprop 2024-04-24alquiler-capital-federal.csv")
## Saco duplicados
Zonaprop <- unique(Zonaprop)
BarriosRecod <- read_excel("Barrios_Recodificado.xlsx")
Barrios_CABA <- st_read("barrios/barrios_wgs84.shp")
Barrios_CABA <- Barrios_CABA %>%
mutate(BARRIO = case_when(
BARRIO == "NUÑEZ" ~ "NUNEZ",
TRUE ~ as.character(BARRIO)
))
Zonaprop <- Zonaprop %>% left_join(BarriosRecod,by = "Barrios")
Zonaprop <- Zonaprop %>%
mutate(RangosPrecio = case_when(
PrecioPesos < 200000 ~ "Menor a 200",
PrecioPesos >= 200000 & PrecioPesos < 400000  ~ "200 a 400",
PrecioPesos >= 400000 & PrecioPesos < 600000  ~ "400 a 600",
PrecioPesos >= 600000 & PrecioPesos < 800000  ~ "600 a 800",
PrecioPesos >= 800000 & PrecioPesos < 1000000  ~ "800 a 1.000",
PrecioPesos >= 1000000 & PrecioPesos < 1500000  ~ "1.000 a 1.500",
PrecioPesos >= 1500000 & PrecioPesos < 2000000  ~ "1.500 a 2.000",
PrecioPesos >= 2000000 ~ "Mayor a 2.000")) %>%
mutate(RangosAmbientes = case_when(
Ambientes == 1 ~ "1 ambiente",
Ambientes == 2 ~ "2 ambientes",
Ambientes == 3 ~ "3 ambientes",
Ambientes == 4 ~ "4 ambientes",
Ambientes > 4  ~ "5 ambientes"))
ResumenBarriosCABA <- Zonaprop %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
# Procesamientos
#### Limpieza bases precio
Zonaprop_Precio <- Zonaprop %>%
filter(!is.na(PrecioPesos) & PrecioPesos < 100000000 & PrecioPesos > 1000)
#### Limpieza base ambientes
Zonaprop_Ambientes <- Zonaprop_Precio %>%
filter(!is.na(Ambientes))
#### RESULTADOS
## Generales
Generales <- Zonaprop_Precio %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
## Generales por ambientes
dt_ambientes <- Zonaprop_Precio %>%
group_by(RangosAmbientes) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(RangosAmbientes)
## Por barrio
dt_barrio <- Zonaprop_Precio %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(desc(Total))
## Por zona. Precio medio y si alquiler está dolarizado o no
dt_zona <- Zonaprop_Precio %>%
group_by(Corredor) %>%
summarise('Total' = n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(desc(Total))
## Por Rango precios. Precio medio y si alquiler está dolarizado o no
dt_rangoprecio <- Zonaprop_Precio %>%
group_by(RangosPrecio) %>%
summarise('Total' = n(),
'Orden' = sum(PrecioPesos) / n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%")) %>%
arrange(Orden) %>%
select(-Orden) %>%
rename("Rangos precio (en miles de pesos)" = RangosPrecio)
## Resumen por Barrio para mapa
resumen_barrio <- Zonaprop_Precio %>%
group_by(Barrio_Recod) %>%
summarise('Total' = n(),
'Precio' = sum(PrecioPesos) / n(),
'Promedio precio' = paste0("$", format(sum(PrecioPesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Promedio precio m2' = paste0("$", format(sum(PrecioM2Pesos) / n(), nsmall = 2, decimal.mark = ",", big.mark = ".")),
'Porcentaje dolarizado' = paste0(format(round(100 * (sum(ifelse(Dolarizado == "si", 1, 0)) / n()), digits = 2), nsmall = 2, decimal.mark = ",", big.mark = "."), "%"))
Resumen_CABA <- Barrios_CABA %>%
left_join(resumen_barrio, by = c("BARRIO" = "Barrio_Recod")) %>%
mutate(Precio = case_when(is.na(Precio) ~ 0,
TRUE ~ as.numeric(Precio)),
Total = case_when(is.na(Total) ~ 0,
TRUE ~ as.numeric(Total)))
## Mapa poligonos
pal <- colorNumeric("Blues", NULL)
#### Limpieza base ambientes
Zonaprop_Ambientes <- Zonaprop %>%
filter(!is.na(Ambientes))
## Filtro para mapa
Zonaprop_Mapa <- Zonaprop_Precio %>%
filter(!is.na(Longitud) & !is.na(Direccion))
a <- Zonaprop_Mapa %>%
filter(RangosPrecio=="Menor a 200") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
b <- Zonaprop_Mapa %>%
filter(RangosPrecio=="200 a 400") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
c <- Zonaprop_Mapa %>%
filter(RangosPrecio=="400 a 600") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
d <- Zonaprop_Mapa %>%
filter(RangosPrecio=="600 a 800") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
e <- Zonaprop_Mapa %>%
filter(RangosPrecio=="800 a 1.000") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
f <- Zonaprop_Mapa %>%
filter(RangosPrecio=="1.000 a 1.500") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
g <- Zonaprop_Mapa %>%
filter(RangosPrecio=="1.500 a 2.000") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
h <- Zonaprop_Mapa %>%
filter(RangosPrecio=="Mayor a 2.000") %>%
filter(!is.na(Longitud) & !is.na(Direccion))
## Valor máximo precios
max_value <- max(Zonaprop_Precio$PrecioPesos)
View(Barrios_CABA)
View(Resumen_CABA)
runApp()
runApp()
